
&НаКлиенте
Процедура КонструктивНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)

	СтандартнаяОбработка = Ложь;
	
	Проект = ПолучитьПроектИзНастроек();

	ДопПараметры = новый Структура;
  	ДопПараметры.Вставить("Проект", Проект);
	ДопПараметры.Вставить("ВерсияИсточника", Неопределено);
 	ДопПараметры.Вставить("Версия", УстановитьВерсию(Проект));
 	ДопПараметры.Вставить("ТолькоWBS", Истина);
 	
 	JJ = Новый ОписаниеОповещения("ВыборРаботыЗавершениеРедактирование", ЭтаФорма);
	
	ОткрытьФорму("Документ.ИНАГРО_УГПР.Форма.ФормаВыбораЭлементаWBS", ДопПараметры ,,,,, JJ);

КонецПроцедуры

&НаСервере
фУНКЦИЯ ПолучитьПроектИзНастроек()
	
	Перем РезультатФ;
	
	ПараметрДанных = Отчет.КомпоновщикНастроек.Настройки.ПараметрыДанных.Элементы.Найти("Проект");
	
	Проект = Отчет.КомпоновщикНастроек.ПользовательскиеНастройки.Элементы.Найти(ПараметрДанных.ИдентификаторПользовательскойНастройки);
	
	Если Проект <> Неопределено Тогда
		
		РезультатФ = Проект.Значение;
		
	КонецЕсли;

	Возврат РезультатФ;
	
КонецФункции

&НаСервереБезКонтекста
Функция  УстановитьВерсию(Проект)
	Возврат Справочники.ИНАГРО_Версия.РабочаяВерсияПроекта(Проект);
КонецФункции

 &НаКлиенте
Процедура ВыборРаботыЗавершениеРедактирование(Результат, ДопПараметры)  Экспорт
	
 	Если Результат = Неопределено Тогда
		Возврат;
	КонецЕсли;
 	
	Для каждого СтрокаРезультата Из Результат  Цикл
		
		Отчет.ОтборWBS = СтрокаРезультата.ВидРаботыСоответствия;
		Отчет.ОтборКлючСтроки = СтрокаРезультата.КлючСтрокиСоответствия;
   		
 	КонецЦикла;

КонецПроцедуры
